<!DOCTYPE html>
<html lang="nl">
<head>
<style>
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: #f5f7fa;
    color: #1f2937;
  }

  .app-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 32px;
    background: white;
    border-bottom: 1px solid #e5e7eb;
  }

  .logo-text {
    font-size: 22px;
    font-weight: 600;
    color: #1f2a44;
  }

  .search input {
    padding: 8px 12px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    width: 220px;
  }

  .container {
    max-width: 900px;
    margin: 24px auto;
    padding: 0 16px;
  }

  .add-client {
    display: flex;
    gap: 10px;
    margin-bottom: 24px;
  }

  .add-client input {
    flex: 1;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
  }

  .add-client button {
    padding: 10px 16px;
    border-radius: 8px;
    border: none;
    background: #1f2a44;
    color: white;
    cursor: pointer;
  }

  .clients {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .client-card {
    background: white;
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    border: 1px solid #e5e7eb;
  }

  .client-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
  }

  .client-header h2 {
    margin: 0;
    font-size: 18px;
  }

  .status-toggle {
    padding: 6px 10px;
    border-radius: 20px;
    font-size: 12px;
    border: none;
  }

  .status-toggle.active {
    background: #e0f2fe;
    color: #0369a1;
  }

  .status-toggle.done {
    background: #ecfeff;
    color: #0f766e;
  }

  .client-summary {
    font-size: 13px;
    color: #6b7280;
    margin-top: 6px;
  }

  .client-body {
    display: none;
    margin-top: 12px;
    border-top: 1px solid #e5e7eb;
    padding-top: 12px;
  }

  .client-card.open .client-body {
    display: block;
  }

  .appointment {
    padding: 10px;
    border-radius: 10px;
    background: #f9fafb;
    margin-bottom: 8px;
  }

  .appointment.online {
    border-left: 4px solid #3b82f6;
  }

  .appointment.fysiek {
    border-left: 4px solid #22c55e;
  }

  .appointment-header {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    font-weight: 500;
  }

  .appointment-notes {
    font-size: 13px;
    color: #374151;
    margin-top: 4px;
    max-height: 40px;
    overflow: hidden;
  }

  .appointment-notes.expanded {
    max-height: none;
  }

  .toggle-notes {
    font-size: 12px;
    color: #2563eb;
    cursor: pointer;
  }

  .add-appointment {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed #d1d5db;
  }

  .add-appointment input,
  .add-appointment textarea,
  .add-appointment select {
    width: 100%;
    padding: 8px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    margin-bottom: 6px;
  }

  .add-appointment button {
    background: #1f2a44;
    color: white;
    border: none;
    padding: 8px 14px;
    border-radius: 8px;
    cursor: pointer;
  }
</style>

</head>
<body>

  <!-- Header -->
  <header class="app-header">
    <div class="logo">
      <!-- Hier komt straks het echte logo -->
      <span class="logo-text">ClarityFlow</span>
    </div>
    <div class="search">
      <input type="text" id="searchInput" placeholder="Zoek klant...">
    </div>
  </header>

  <!-- Hoofdcontent -->
  <main class="container">

    <!-- Klant toevoegen -->
    <section class="add-client">
      <input type="text" id="newClientName" placeholder="Naam nieuwe klant">
      <button id="addClientBtn">Klant toevoegen</button>
    </section>

    <!-- Klantkaarten -->
    <section id="clientsContainer" class="clients">

      <!-- Voorbeeld kaart (wordt straks dynamisch via JS) -->
      <!--
      <div class="client-card">
        <div class="client-header">
          <h2>Jan de Vries</h2>
          <button class="status-toggle active">Actief</button>
        </div>

        <div class="client-summary">
          Laatste afspraak: 12-01-2026 10:00 (Online)
        </div>

        <div class="client-body">
          <div class="appointments">
            <!-- afspraken komen hier -->
          </div>

          <div class="add-appointment">
            <!-- inline formulier komt hier -->
          </div>
        </div>
      </div>
      -->

    </section>

  </main>

<script>
let clients = JSON.parse(localStorage.getItem("clients")) || [];

const clientsContainer = document.getElementById("clientsContainer");
const addClientBtn = document.getElementById("addClientBtn");
const newClientName = document.getElementById("newClientName");
const searchInput = document.getElementById("searchInput");

function save() {
  localStorage.setItem("clients", JSON.stringify(clients));
}

function formatDateTime(value) {
  const d = new Date(value);
  const day = String(d.getDate()).padStart(2, "0");
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const year = d.getFullYear();
  const hours = String(d.getHours()).padStart(2, "0");
  const minutes = String(d.getMinutes()).padStart(2, "0");
  return `${day}-${month}-${year} ${hours}:${minutes}`;
}

function render() {
  clientsContainer.innerHTML = "";

  const search = searchInput.value.toLowerCase();

  clients
    .filter(c => c.name.toLowerCase().includes(search))
    .forEach((client, index) => {
      const card = document.createElement("div");
      card.className = "client-card";

      const header = document.createElement("div");
      header.className = "client-header";
      header.innerHTML = `
        <h2>${client.name}</h2>
        <button class="status-toggle ${client.status}">
          ${client.status === "active" ? "üü¢ Actief" : "‚ö™ Afgerond"}
        </button>
      `;

      header.querySelector(".status-toggle").onclick = (e) => {
        e.stopPropagation();
        client.status = client.status === "active" ? "done" : "active";
        save();
        render();
      };

      header.onclick = () => {
        card.classList.toggle("open");
      };

      const summary = document.createElement("div");
      summary.className = "client-summary";
      if (client.appointments.length > 0) {
        const last = client.appointments[client.appointments.length - 1];
        summary.textContent = `Laatste afspraak: ${formatDateTime(last.datetime)} (${last.type === "online" ? "Online" : "Fysiek"})`;
      } else {
        summary.textContent = "Nog geen afspraken";
      }

      const body = document.createElement("div");
      body.className = "client-body";

      client.appointments
        .sort((a, b) => new Date(a.datetime) - new Date(b.datetime))
        .forEach((appt, i) => {
          const apptDiv = document.createElement("div");
          apptDiv.className = `appointment ${appt.type}`;

          apptDiv.innerHTML = `
            <div class="appointment-header">
              <span>${formatDateTime(appt.datetime)} ‚Äì ${appt.type === "online" ? "Online" : "Fysiek"}</span>
              <span>
                <button onclick="editAppointment(${index}, ${i})">‚úèÔ∏è</button>
                <button onclick="toggleDone(${index}, ${i})">‚úîÔ∏è</button>
              </span>
            </div>
            <div class="appointment-notes">${appt.notes}</div>
            ${appt.notes.length > 80 ? `<span class="toggle-notes" onclick="toggleNotes(this)">Meer tonen</span>` : ""}
          `;

          body.appendChild(apptDiv);
        });

      const addForm = document.createElement("div");
      addForm.className = "add-appointment";
      addForm.innerHTML = `
        <input type="datetime-local" placeholder="Datum & tijd">
        <select>
          <option value="online">Online</option>
          <option value="fysiek">Fysiek</option>
        </select>
        <textarea placeholder="Notities"></textarea>
        <button>Afspraak toevoegen</button>
      `;

      const [dtInput, typeSelect, notesInput, addBtn] = addForm.children;

      addBtn.onclick = () => {
        if (!dtInput.value) return;

        client.appointments.push({
          datetime: dtInput.value,
          type: typeSelect.value,
          notes: notesInput.value,
          done: false
        });

        save();
        render();
      };

      body.appendChild(addForm);

      card.appendChild(header);
      card.appendChild(summary);
      card.appendChild(body);

      clientsContainer.appendChild(card);
    });
}

function toggleNotes(el) {
  const notes = el.previousElementSibling;
  notes.classList.toggle("expanded");
  el.textContent = notes.classList.contains("expanded") ? "Minder tonen" : "Meer tonen";
}

function toggleDone(clientIndex, apptIndex) {
  clients[clientIndex].appointments[apptIndex].done = !clients[clientIndex].appointments[apptIndex].done;
  save();
  render();
}

function editAppointment(clientIndex, apptIndex) {
  const appt = clients[clientIndex].appointments[apptIndex];
  alert("Bewerken komt in de volgende stap (structuur staat al klaar).");
}

addClientBtn.onclick = () => {
  if (!newClientName.value.trim()) return;

  clients.push({
    name: newClientName.value,
    status: "active",
    appointments: []
  });

  newClientName.value = "";
  save();
  render();
};

searchInput.oninput = render;

render();
</script>

