<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Mijn klanten ‚Äì ClarityFlow</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f6f7f9;
  padding: 30px;
  margin: 0;
}

.container {
  max-width: 1200px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

h1 {
  text-align: center;
}

/* Invoer */
input, textarea, select {
  width: 100%;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
  margin-bottom: 8px;
}

textarea {
  resize: none;
  height: 60px;
}

button {
  padding: 6px 10px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

.add {
  background: #1f2a44;
  color: white;
  margin-bottom: 15px;
}

/* Filters */
.controls {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

/* Tabel */
table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed; /* CRUCIAAL */
}

th, td {
  padding: 10px;
  vertical-align: top;
  border-right: 1px solid #ddd;
}

th:last-child,
td:last-child {
  border-right: none;
}

th {
  background: #f1f3f6;
  border-bottom: 2px solid #ccc;
}

tr {
  border-bottom: 1px solid #ddd;
}

tr.done {
  background: #e6f4ea;
  color: #666;
  text-decoration: line-through;
}

/* Kolombreedtes */
.col-naam { width: 15%; }
.col-datum { width: 18%; }
.col-locatie { width: 17%; }
.col-notities { width: 30%; }
.col-acties { width: 20%; }

/* Notities */
.note {
  max-height: 40px;        /* ¬± 2 regels */
  overflow: hidden;
  white-space: pre-wrap;
  word-break: break-word;
}

.note.expanded {
  max-height: none;
}

.toggle {
  display: inline-block;
  font-size: 12px;
  color: #1f2a44;
  cursor: pointer;
  margin-top: 4px;
}

/* Labels */
.badge {
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 12px;
  display: inline-block;
  margin-bottom: 4px;
}

.online {
  background: #e3f2fd;
  color: #1565c0;
}

.fysiek {
  background: #e8f5e9;
  color: #2e7d32;
}
</style>
</head>

<body>
<div class="container">

<h1>Mijn klanten</h1>

<!-- Invoer -->
<input id="naam" placeholder="Naam klant">
<input id="datetime" type="datetime-local">
<select id="locatieType">
  <option value="online">Online afspraak</option>
  <option value="fysiek">Fysieke afspraak</option>
</select>
<input id="locatie" placeholder="Locatie (Zoom / Kantoor / Adres)">
<textarea id="notities" placeholder="Notities"></textarea>
<button class="add" onclick="addClient()">Toevoegen</button>

<!-- Filters -->
<div class="controls">
  <input id="search" placeholder="Zoek op klantnaam" oninput="render()">
  <select id="filter" onchange="render()">
    <option value="all">Alles</option>
    <option value="open">Open</option>
    <option value="done">Afgerond</option>
  </select>
</div>

<table>
<thead>
<tr>
  <th class="col-naam">Naam</th>
  <th class="col-datum">Datum & tijd</th>
  <th class="col-locatie">Locatie</th>
  <th class="col-notities">Notities</th>
  <th class="col-acties">Acties</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

</div>

<script>
let clients = JSON.parse(localStorage.getItem("clients")) || [];

function formatDate(value) {
  const d = new Date(value);
  return `${String(d.getDate()).padStart(2,"0")}-${String(d.getMonth()+1).padStart(2,"0")}-${d.getFullYear()} ${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`;
}

function save() {
  localStorage.setItem("clients", JSON.stringify(clients));
}

function render() {
  const body = document.getElementById("tableBody");
  body.innerHTML = "";

  const search = searchInput().toLowerCase();
  const filter = filterSelect();

  clients
    .sort((a,b) => new Date(a.datetime) - new Date(b.datetime))
    .filter(c => c.naam.toLowerCase().includes(search))
    .filter(c => filter === "all" || (filter === "open" && !c.done) || (filter === "done" && c.done))
    .forEach((c,i) => {

      const row = document.createElement("tr");
      if (c.done) row.classList.add("done");

      row.innerHTML = `
        <td class="col-naam">${c.naam}</td>
        <td class="col-datum">${formatDate(c.datetime)}</td>
        <td class="col-locatie">
          <span class="badge ${c.type}">${c.type === "online" ? "Online" : "Fysiek"}</span><br>
          ${c.locatie}
        </td>
        <td class="col-notities">
          <div class="note">${c.notities}</div>
          ${c.notities.length > 60 ? `<span class="toggle" onclick="toggleNote(this)">Meer tonen</span>` : ""}
        </td>
        <td class="col-acties">
          <button onclick="edit(${i})">‚úèÔ∏è</button>
          <button onclick="toggleDone(${i})">‚úîÔ∏è</button>
          <button onclick="remove(${i})">üóëÔ∏è</button>
        </td>
      `;
      body.appendChild(row);
    });
}

function searchInput() {
  return document.getElementById("search").value;
}

function filterSelect() {
  return document.getElementById("filter").value;
}

function addClient() {
  if (!naam.value) return;

  clients.push({
    naam: naam.value,
    datetime: datetime.value,
    type: locatieType.value,
    locatie: locatie.value,
    notities: notities.value,
    done: false
  });

  naam.value = datetime.value = locatie.value = notities.value = "";
  save();
  render();
}

function edit(i) {
  const c = clients[i];
  naam.value = c.naam;
  datetime.value = c.datetime;
  locatieType.value = c.type;
  locatie.value = c.locatie;
  notities.value = c.notities;
  clients.splice(i,1);
  save();
  render();
}

function toggleDone(i) {
  clients[i].done = !clients[i].done;
  save();
  render();
}

function remove(i) {
  if (confirm("Weet je zeker dat je deze klant wilt verwijderen?")) {
    clients.splice(i,1);
    save();
    render();
  }
}

function toggleNote(el) {
  const note = el.previousElementSibling;
  note.classList.toggle("expanded");
  el.textContent = note.classList.contains("expanded") ? "Minder tonen" : "Meer tonen";
}

render();
</script>

</body>
</html>
